# 📘 START HERE - プロジェクト概要

**不動産ポータルサイト** のプロジェクトドキュメントへようこそ。

このドキュメントは、プロジェクトの全体像を素早く理解するためのガイドです。

---

## 🎯 このプロジェクトは何か？

**「物件を探すサービス」ではなく「不要な物件を消していくサービス」**

既存の不動産ポータルの課題：
- 条件検索しても無関係な物件が大量に出る
- すべて疑いながら見る必要がある
- 却下した物件が何度も表示される

→ **判断コストを極限まで下げる** ことが目的

詳細は → [要件定義.md](要件定義.md)

---

## 📊 現在の状態

### Phase 0: PoC検証中

| 項目 | 状態 |
|------|------|
| 基本スクレイピング | ✅ 実装済み |
| 検索機能 | ✅ 実装済み（Meilisearch） |
| フィルタ | ✅ 実装済み（賃料・間取り・徒歩時間） |
| 技術スタック | ⚠️ PostgreSQL → MySQL移行必要 |
| | ⚠️ React+Vite → Next.js移行必要 |
| 差分検出 | ⏳ 未実装（設計完了） |
| 物理削除 | ⏳ 未実装（設計完了） |

---

## 📚 ドキュメント構成

### 🌟 最初に読むべきもの

1. **[要件定義.md](要件定義.md)** - サービスの差別化ポイント・コンセプト
2. **[技術構成.md](技術構成.md)** - 技術スタック・アーキテクチャ全体像
3. **[TODO.md](TODO.md)** - 実装タスク一覧と優先順位

### 📋 仕様・設計書

| ドキュメント | 内容 | いつ読む？ |
|------------|------|-----------|
| [SPECIFICATION.md](SPECIFICATION.md) | 現在のPoC仕様（API仕様） | 実装時・APIを使う時 |
| [ER図.md](ER図.md) | データベース設計 | DB設計・マイグレーション時 |
| [GORM_モデル定義.md](GORM_モデル定義.md) | MySQL + GORM モデル | Phase 1の技術移行時 |

### 🔧 実装設計書

| ドキュメント | 内容 | いつ読む？ |
|------------|------|-----------|
| [Phase3_差分検出_実装設計.md](Phase3_差分検出_実装設計.md) | 差分検出バッチのGo実装 | Phase 3実装時 |
| [論理削除と物理削除の設計.md](論理削除と物理削除の設計.md) | データライフサイクル設計 | Phase 4.5実装時 |

---

## 🚀 クイックスタート

### 環境構築

```bash
# プロジェクトディレクトリに移動
cd /Users/shu/Documents/dev/real-estate-portal

# Dockerコンテナ起動
docker-compose up -d

# アクセス確認
# Frontend: http://localhost:5176
# Backend API: http://localhost:8084
# Meilisearch: http://localhost:7700
```

### 動作確認

1. ブラウザで http://localhost:5176 を開く
2. Yahoo不動産の物件URLを入力してスクレイピング
3. 検索・フィルタで物件を絞り込み

詳細は → [README.md](../README.md)

---

## 🎯 次にやるべきこと（Phase別）

### Phase 0: PoC検証（最優先）

- [ ] スクレイピング3回連続成功テスト
- [ ] 検索機能の動作確認
- [ ] 画像表示の確認（24時間後も表示されるか）
- [ ] Yahoo不動産へのリンク確認

**合格基準**: 上記4項目すべてクリア

詳細は → [TODO.md](TODO.md) Phase 0

---

### Phase 1: 技術スタック修正

- PostgreSQL → MySQL 8.x
- React+Vite → Next.js 14
- 直接SQL → GORM

詳細は → [TODO.md](TODO.md) Phase 1

---

### Phase 2: 機能改善

- URL正規化
- 画像URL生存確認
- 正規表現抽出の改善

詳細は → [TODO.md](TODO.md) Phase 2

---

### Phase 3: 差分検出・毎日更新

- daily_property_snapshots テーブル作成
- 一覧取得機能
- 差分判定ロジック
- 論理削除実装

詳細は → [Phase3_差分検出_実装設計.md](Phase3_差分検出_実装設計.md)

---

## 📖 ドキュメントの読み方

### シナリオ別ガイド

#### 「プロジェクト全体を理解したい」
1. [要件定義.md](要件定義.md) - サービスの価値を理解
2. [技術構成.md](技術構成.md) - 技術選定の背景を理解
3. [TODO.md](TODO.md) - 開発の進捗と次のステップを確認

#### 「今すぐ開発を始めたい」
1. [TODO.md](TODO.md) - 最優先タスクを確認
2. [SPECIFICATION.md](SPECIFICATION.md) - 現在のAPI仕様を確認
3. [ER図.md](ER図.md) - データベース構造を確認

#### 「Phase 3（差分検出）を実装したい」
1. [TODO.md](TODO.md) Phase 3 - タスク一覧を確認
2. [Phase3_差分検出_実装設計.md](Phase3_差分検出_実装設計.md) - Go擬似コードを参照
3. [ER図.md](ER図.md) - テーブル定義を確認
4. [GORM_モデル定義.md](GORM_モデル定義.md) - モデル実装を参照

#### 「技術移行（MySQL / Next.js）をしたい」
1. [技術構成.md](技術構成.md) - 目標構成を確認
2. [GORM_モデル定義.md](GORM_モデル定義.md) - MySQL + GORM移行手順
3. [TODO.md](TODO.md) Phase 1 - 移行タスク一覧

---

## ⚠️ 重要な注意事項

### データ管理の鉄則

- ❌ **既存データの削除禁止**
- ❌ **Dockerコンテナの破壊禁止**
- ❌ **マイグレーション時のリフレッシュ禁止**
- ✅ **論理削除を使用**（物理削除しない）

### スクレイピングの原則

- 同時実行数: **1**
- リクエスト間隔: **2秒以上**
- エラー時: **即停止**
- 1日の最大リクエスト数: **5000件**

詳細は → [TODO.md](TODO.md) Phase 4

---

## 🗂️ ディレクトリ構造

```
real-estate-portal/
├── README.md                    # プロジェクト概要
├── docker-compose.yml           # Docker構成
├── docs/                        # 📚 ドキュメント
│   ├── START_HERE.md           # ← 今ここ！
│   ├── 要件定義.md              # サービスコンセプト
│   ├── 技術構成.md              # 技術スタック
│   ├── TODO.md                 # タスク一覧
│   ├── SPECIFICATION.md        # API仕様書
│   ├── ER図.md                 # DB設計
│   ├── Phase3_差分検出_実装設計.md
│   ├── GORM_モデル定義.md
│   └── 論理削除と物理削除の設計.md
├── backend/                     # Goバックエンド
│   ├── cmd/api/                # メインAPI
│   └── internal/
│       ├── models/             # データモデル
│       ├── scraper/            # スクレイピング
│       ├── database/           # PostgreSQL
│       └── search/             # Meilisearch
└── frontend/                    # Reactフロントエンド
    └── src/
        ├── App.jsx
        └── App.css
```

---

## 💡 よくある質問

### Q1. このプロジェクトの最終目標は？

**A**: **「物件を探す」のではなく「不要な物件を消していく」体験を提供する不動産ポータル**

差別化ポイント:
- ワンタップ非表示（使うほど検索結果が減る）
- ◎/△/× による許容幅検索
- 相違報告（表記と実態の違いを可視化）

詳細は → [要件定義.md](要件定義.md)

---

### Q2. なぜNext.jsとGoの構成？

**A**:
- **Next.js**: SEO・OGP・URL共有を重視（LP・物件詳細ページ）
- **Go**: 高速・並行処理に強い（スクレイピング・API）
- **MySQL**: 実績豊富、シンVPSでの運用に適している
- **Meilisearch**: 高速全文検索、フィルタ機能が強力

詳細は → [技術構成.md](技術構成.md)

---

### Q3. 現在の技術スタックと目標構成が違うのはなぜ？

**A**: **PoC段階で技術検証を優先したため**

| 項目 | 現在（PoC） | 目標（Phase 1以降） |
|------|------------|-------------------|
| Frontend | React + Vite | Next.js 14 |
| Database | PostgreSQL | MySQL 8.x |
| ORM | 直接SQL | GORM |

Phase 1で技術スタック移行を予定

詳細は → [TODO.md](TODO.md) Phase 1

---

### Q4. データの削除方針は？

**A**: **3段階で管理**

1. **論理削除（即時）**: `status = 'removed'` で検索から除外
2. **保留期間（30〜90日）**: データは保持（復活可能）
3. **物理削除（週1回）**: 古いデータを削除（容量最適化）

詳細は → [論理削除と物理削除の設計.md](論理削除と物理削除の設計.md)

---

### Q5. スクレイピングは合法？

**A**: **PoC段階は技術検証目的のみ**

- 商用利用には Yahoo! との提携が必要
- robots.txt を遵守
- アクセス頻度を制限（1リクエスト/2秒）
- 将来的には提携・API連携に移行予定

詳細は → [要件定義.md](要件定義.md) 12章

---

## 🔗 外部リソース

- [Go公式](https://go.dev/)
- [Next.js公式](https://nextjs.org/)
- [GORM公式](https://gorm.io/)
- [Meilisearch公式](https://www.meilisearch.com/)

---

## 📞 困ったときは

1. **エラーが出た**: [README.md](../README.md) のトラブルシューティングを確認
2. **実装方針が不明**: [TODO.md](TODO.md) で該当Phaseを確認
3. **設計が理解できない**: [Phase3_差分検出_実装設計.md](Phase3_差分検出_実装設計.md) のGo擬似コードを参照

---

## 🎓 学習パス

### 初心者向け

1. [要件定義.md](要件定義.md) - サービスの価値を理解
2. [README.md](../README.md) - 環境構築・動作確認
3. [SPECIFICATION.md](SPECIFICATION.md) - APIを触ってみる

### 開発者向け

1. [技術構成.md](技術構成.md) - アーキテクチャ全体を理解
2. [ER図.md](ER図.md) - データベース構造を理解
3. [Phase3_差分検出_実装設計.md](Phase3_差分検出_実装設計.md) - 実装パターンを学ぶ

### アーキテクト向け

1. [技術構成.md](技術構成.md) - 技術選定の背景
2. [論理削除と物理削除の設計.md](論理削除と物理削除の設計.md) - データライフサイクル設計
3. [TODO.md](TODO.md) - 全体のロードマップ

---

**最終更新**: 2025-12-16

次のステップ: [TODO.md](TODO.md) を開いて Phase 0 の PoC検証を開始！
