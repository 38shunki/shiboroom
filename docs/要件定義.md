# 不動産ポータルサイト 要件定義書

**プロジェクト名**：不動産ポータル（仮）
**フェーズ**：PoC → MVP → 初期運用
**最終更新日**：2025-12-16

---

## 1. サービス概要（差別化の要点）

本サービスは
**「物件を探すサービス」ではなく「不要な物件を消していくサービス」** である。

既存の不動産ポータルは以下の課題を抱えている。

* 条件検索をしても無関係な物件が大量に出る
* 表記が正しいか分からず、すべて疑いながら見る必要がある
* 却下した物件が何度も表示される
* 検索すればするほど疲れる

本サービスはこれらを前提から捨て、
**判断コストを極限まで下げること** を目的とする。

---

## 2. 独自機能（コア差別化）

### 2.1 ワンタップ非表示（探さない検索）

* 気に入らない物件を即座に非表示
* 一度非表示にした物件は再表示されない
* ユーザー単位で管理（他人に影響しない）

**価値**
検索結果は「使うほど減る」
＝ 検索疲れが起きない

---

### 2.2 ◎ / △ / × による許容幅検索

従来の Yes / No 条件指定ではなく、
人間の判断に近い三段階指定を採用する。

例：駅徒歩

* ◎：〜8分
* △：9〜10分
* ×：11分以上（表示しない）

**価値**
「条件は満たしているが微妙」な物件を最初から除外できる。

---

### 2.3 相違報告（訂正しない設計）

* 表記と実態が違うと感じた点をユーザーが報告
* 運営は正誤を断定しない
* 「相違がある可能性」を可視化するのみ

例：

* 独立洗面台の表記が怪しい
* 面積の内訳が不明
* 写真と印象が違う

**価値**
すべての物件を疑って見る必要がなくなる。

---

### 2.4 広さ・条件の「不明」を隠さない

* 専有面積かどうか不明な場合は「不明」と明示
* 曖昧な数値を無理に補正しない

**価値**
「信用できるかどうか」をユーザーが判断できる。

---

### 2.5 判断履歴の保存

* 却下理由
* 内見後メモ
* 個人用メモ（非公開）

**価値**
同じ物件を何度も検討する無駄をなくす。

---

## 3. サービスの一言定義

* 探す量を減らす不動産ポータル
* 地雷を踏まないための賃貸検索
* 条件に嘘がないか分かる不動産サイト

---

## 4. スコープ定義

### 4.1 含まれるもの

* Yahoo不動産の物件情報取得（PoC段階）
* 条件検索・フィルタ
* 非表示・メモ・相違報告（ユーザー単位）
* 毎日の物件更新・消滅検出
* Webブラウザ向けUI

### 4.2 含まれないもの

* 仲介・契約・内見予約
* 不動産会社との直接取引
* 商用利用（PoC段階では不可）

---

## 5. 技術構成

### 5.1 全体構成

```
Next.js（Web）
   ↓
Go API（Gin / GORM）
   ↓
MySQL / Redis
   ↓
Meilisearch
```

### 5.2 フロントエンド

* Next.js 14（App Router）
* TypeScript
* Tailwind CSS
* Radix UI
* React Query
* Zustand
* SSG / SSR / CSR 混在

### 5.3 バックエンド

* Go 1.22+
* Gin
* GORM
* MySQL 8.x
* Meilisearch
* golang-migrate
* cron / asynq（バッチ処理）

### 5.4 インフラ

* シンVPS
* Docker / Docker Compose
* 将来的に AWS へ移行可能な設計

---

## 6. データ取得・更新方針

### 6.1 取得方法

* Yahoo不動産の **検索一覧ページ** をエリア単位で取得
* 物件ID + detail_url のみを一覧で収集
* 新規物件のみ詳細ページを取得

### 6.2 更新頻度

* 1日1回（深夜〜早朝）
* 固定時刻
* 並列実行なし

---

## 7. 物件のライフサイクル管理

### 7.1 論理削除

* 一覧から消えた物件は `status = removed`
* 検索結果から即除外
* Meilisearchから削除

### 7.2 物理削除（将来）

* removed 状態で一定期間経過後に削除
* スナップショット・ログは保持
* データ容量抑制目的

---

## 8. 差分検出設計

### 8.1 日次スナップショット

* 毎日「存在している物件ID一覧」を保存
* 前日との差分で新規・消滅を判定

### 8.2 処理順序

1. 一覧取得（全エリア）
2. スナップショット保存
3. 差分判定
4. 新規物件の詳細取得
5. 消滅物件の論理削除

---

## 9. BAN・負荷対策

* 同時実行数：1
* リクエスト間隔：2秒以上
* 1日最大リクエスト数制限
* 403 / 429 / 5xx 発生時は即停止
* robots.txt 遵守
* User-Agent 明示

---

## 10. 管理機能（内部）

* 今日の新規件数
* 今日の消滅件数
* エリア別成功率
* 最終実行日時
* エラーログ確認
* 手動実行（制限付き）

---

## 11. 非機能要件

### 11.1 パフォーマンス

* 検索：100〜300ms
* 詳細表示：即時
* バッチ処理：数時間以内完了

### 11.2 可用性

* 途中失敗時は公開データを更新しない
* 中途半端な状態をユーザーに見せない

---

## 12. 法的・運用上の注意

* 本サービスは技術検証目的
* 商用利用には提携・許諾が必要
* 画像は外部参照のみ
* データの正誤は保証しない

---

## 13. 今後の拡張

* お気に入り・比較
* 通知（条件マッチ）
* 地図表示
* アフィリエイト連携
* ユーザー投稿による知見蓄積

---

## 14. まとめ

本サービスの価値は
**物件数・網羅性ではなく、判断のしやすさ** にある。

「探す」のではなく
**「もう見なくていい物件を消していく」**
という体験を提供する。
